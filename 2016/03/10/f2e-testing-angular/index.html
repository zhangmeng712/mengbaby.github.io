<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>前端自动化测试（三）- angular和protracor | 萌小主前端部落 | the more you know the more you know you don&#39;t know</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="nodejs,angular,e2e,protractor">
    <meta name="description" content="protractor用于前端UI自动化测试,特别为angular程序定制 特点 端对端(e2e)测试 采用jasmine作为测试框架 基于WebDriverJS,(selenium-webdriver) 针对angular应用增加定位器,更加方便实用 实现自动等待,告别sleep wait,变异步为同步 支持测试代码的调试 支持多浏览器的并行UI测试  使用方法准备工作 1 安装protracto">
<meta name="keywords" content="nodejs,angular,e2e,protractor">
<meta property="og:type" content="article">
<meta property="og:title" content="前端自动化测试（三）- angular和protracor">
<meta property="og:url" content="https://mengbaby.github.io/2016/03/10/f2e-testing-angular/index.html">
<meta property="og:site_name" content="萌小主前端部落">
<meta property="og:description" content="protractor用于前端UI自动化测试,特别为angular程序定制 特点 端对端(e2e)测试 采用jasmine作为测试框架 基于WebDriverJS,(selenium-webdriver) 针对angular应用增加定位器,更加方便实用 实现自动等待,告别sleep wait,变异步为同步 支持测试代码的调试 支持多浏览器的并行UI测试  使用方法准备工作 1 安装protracto">
<meta property="og:updated_time" content="2017-04-17T07:02:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端自动化测试（三）- angular和protracor">
<meta name="twitter:description" content="protractor用于前端UI自动化测试,特别为angular程序定制 特点 端对端(e2e)测试 采用jasmine作为测试框架 基于WebDriverJS,(selenium-webdriver) 针对angular应用增加定位器,更加方便实用 实现自动等待,告别sleep wait,变异步为同步 支持测试代码的调试 支持多浏览器的并行UI测试  使用方法准备工作 1 安装protracto">
    
        <link rel="alternate" type="application/atom+xml" title="萌小主前端部落" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@1.6.1/css/style.css">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpeg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Dr Meng</h5>
          <a href="mailto:zhangmeng712@gmail.com" title="zhangmeng712@gmail.com" class="mail">zhangmeng712@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zhangmeng712"  >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">前端自动化测试（三）- angular和protracor</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">前端自动化测试（三）- angular和protracor</h1>
        <h5 class="subtitle">
            
                <time datetime="2016-03-09T20:53:58.000Z" itemprop="datePublished" class="page-time">
  2016-03-10
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/nodejs/">nodejs</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/nodejs/testing/">testing</a></li></ul></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#特点"><span class="post-toc-number">1.</span> <span class="post-toc-text">特点</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用方法"><span class="post-toc-number">2.</span> <span class="post-toc-text">使用方法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#准备工作"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">准备工作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#spec书写"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">spec书写</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#运行"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">运行</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#grunt运行测试"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">grunt运行测试</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#调试测试程序"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">调试测试程序</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#测试非angular的应用"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">测试非angular的应用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#protractor的详细使用"><span class="post-toc-number">3.</span> <span class="post-toc-text">protractor的详细使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#浏览器的操作-browser"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">浏览器的操作-browser</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#选择器-by-amp-element"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">选择器- by & element</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ExpectedConditions"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">ExpectedConditions</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#综合实例"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">综合实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#page-object-pattern"><span class="post-toc-number">4.</span> <span class="post-toc-text">page object pattern</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#mobile端的测试"><span class="post-toc-number">5.</span> <span class="post-toc-text">mobile端的测试</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#e2e测试程序设计准则"><span class="post-toc-number">6.</span> <span class="post-toc-text">e2e测试程序设计准则</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考代码"><span class="post-toc-number">7.</span> <span class="post-toc-text">参考代码</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-f2e-testing-angular"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">前端自动化测试（三）- angular和protracor</h1>
        <div class="post-meta">
            <time class="post-time" title="2016-03-10 04:53:58" datetime="2016-03-09T20:53:58.000Z"  itemprop="datePublished">2016-03-10</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/nodejs/">nodejs</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/nodejs/testing/">testing</a></li></ul></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p><a href="http://angular.github.io/protractor/#/" target="_blank">protractor</a>用于前端UI自动化测试,特别为angular程序定制</p>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul>
<li>端对端(e2e)测试</li>
<li>采用jasmine作为测试框架</li>
<li>基于WebDriverJS,(selenium-webdriver)</li>
<li>针对angular应用增加定位器,更加方便实用</li>
<li>实现自动等待,告别sleep wait,变异步为同步</li>
<li>支持测试代码的调试</li>
<li>支持多浏览器的并行UI测试</li>
</ul>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ul>
<li>1 安装protractor: npm install -g protractor</li>
<li>2 安装selenium-standlone: webdriver-manager update</li>
<li>3 启动selenium服务器: webdriver-manager start</li>
</ul>
<h3 id="spec书写"><a href="#spec书写" class="headerlink" title="spec书写"></a>spec书写</h3><p>spec.js是用于书写测试用例的文件, protractor默认使用jasmine作为测试框架,举最简单的例子来说,一个spec文件可以这样写,使用describe作为<br>测试程序”块”, it定义一个用例,expect作为断言,其中browser这个全局的变量,用于操作浏览器.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Protractor Demo App'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    it(<span class="string">'should have a title'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        browser.get(<span class="string">'http://juliemr.github.io/protractor-demo/'</span>);</div><div class="line">        expect(browser.getTitle()).toEqual(<span class="string">'Super Calculator'</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><ul>
<li>配置conf.json<br>在测试之前,我们需要建立一个conf.json的文件,在这个文件中,可以配置测试的相关内容,例如:<ul>
<li>multiCapabilities:使用哪些浏览器测试</li>
<li>chromeOptions:chrome浏览器的运行参数(使用哪些插件等)</li>
<li>framework:使用哪种测试框架: cucumber macha 还是jasmine</li>
<li>specs:测试哪些文件<br>详细的配置信息请<a href="https://github.com/angular/protractor/blob/master/docs/referenceConf.js" target="_blank">参考</a></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">exports.config = &#123;</div><div class="line">   <span class="comment">// directConnect: true,</span></div><div class="line"></div><div class="line">    <span class="comment">// Capabilities to be passed to the webdriver instance.</span></div><div class="line">    <span class="comment">//capabilities: &#123;</span></div><div class="line">    <span class="comment">//    'browserName': 'chrome'</span></div><div class="line">    <span class="comment">//&#125;,</span></div><div class="line">    multiCapabilities: [ &#123;</div><div class="line">        <span class="string">'browserName'</span>: <span class="string">'chrome'</span>,</div><div class="line">        <span class="comment">//'chromeOptions': &#123;</span></div><div class="line">        <span class="comment">//    'args': ['--load-extension=/opt/local/share/nginx/html/radar/tanxtag'],</span></div><div class="line">        <span class="comment">//&#125;</span></div><div class="line">    &#125;],</div><div class="line">    <span class="comment">// Framework to use. Jasmine is recommended.</span></div><div class="line">    framework: <span class="string">'jasmine'</span>,</div><div class="line"></div><div class="line">    <span class="comment">// Spec patterns are relative to the current working directly when</span></div><div class="line">    <span class="comment">// protractor is called.</span></div><div class="line">    specs: [<span class="string">'basic/demo_spec.js'</span>,<span class="string">'basic/angular_spec.js'</span>],</div><div class="line"></div><div class="line">    <span class="comment">// Options to be passed to Jasmine.</span></div><div class="line">    jasmineNodeOpts: &#123;</div><div class="line">        <span class="attr">defaultTimeoutInterval</span>: <span class="number">30000</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li>运行测试程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">protractor conf.json</div></pre></td></tr></table></figure>
<h3 id="grunt运行测试"><a href="#grunt运行测试" class="headerlink" title="grunt运行测试"></a>grunt运行测试</h3><p>有时我们需要使用grunt来配置测试任务,下面就是使用<a href="https://www.npmjs.com/package/grunt-concurrent" target="_blank">grunt-concurrent</a> 模块实现并行运行多浏览器(也可通过conf.json中配置multiCapabilities解决)测试程序的代码:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">grunt</span> =&gt;</span> &#123;</div><div class="line">    <span class="comment">//This module will read the dependencies/devDependencies/peerDependencies/optionalDependencies in your package.json</span></div><div class="line">    <span class="comment">// and load grunt tasks that match the provided patterns.</span></div><div class="line">    <span class="built_in">require</span>(<span class="string">'load-grunt-tasks'</span>)(grunt);</div><div class="line">    grunt.initConfig(&#123;</div><div class="line">        <span class="attr">concurrent</span>: &#123;</div><div class="line">            <span class="attr">protractor_test</span>: [<span class="string">'protractor-chrome'</span>, <span class="string">'protractor-firefox'</span>, <span class="string">'protractor-safari'</span>]</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">protractor</span>: &#123;</div><div class="line">            <span class="attr">options</span>: &#123;</div><div class="line">                <span class="attr">keepAlive</span>: <span class="literal">true</span>,</div><div class="line">                <span class="attr">singleRun</span>: <span class="literal">false</span>,</div><div class="line">                <span class="attr">configFile</span>: <span class="string">"conf.js"</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">run_chrome</span>: &#123;</div><div class="line">                <span class="attr">options</span>: &#123;</div><div class="line">                    <span class="attr">args</span>: &#123;</div><div class="line">                        <span class="attr">browser</span>: <span class="string">"chrome"</span></div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">run_firefox</span>: &#123;</div><div class="line">                <span class="attr">options</span>: &#123;</div><div class="line">                    <span class="attr">args</span>: &#123;</div><div class="line">                        <span class="attr">browser</span>: <span class="string">"firefox"</span></div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">run_safari</span>: &#123;</div><div class="line">                <span class="attr">options</span>: &#123;</div><div class="line">                    <span class="attr">args</span>: &#123;</div><div class="line">                        <span class="attr">browser</span>: <span class="string">"safari"</span></div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    grunt.registerTask(<span class="string">'protractor-chrome'</span>, [<span class="string">'protractor:run_chrome'</span>]);</div><div class="line">    grunt.registerTask(<span class="string">'protractor-firefox'</span>, [<span class="string">'protractor:run_firefox'</span>]);</div><div class="line">    grunt.registerTask(<span class="string">'protractor-safari'</span>, [<span class="string">'protractor:run_safari'</span>]);</div><div class="line">    grunt.registerTask(<span class="string">'protractor-e2e'</span>, [<span class="string">'concurrent:protractor_test'</span>]);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="调试测试程序"><a href="#调试测试程序" class="headerlink" title="调试测试程序"></a>调试测试程序</h3><p>除了非常方便的运行机制,protractor还提供便捷的调试方式, 使用selenium-webdriver操纵浏览器的时候,调试是非常困难的,在这里protractor就提供调试方式<br>在代码中加入 browser.pause(); 并且在终端输入 “repl” 就可以使用WebDriver commands来调试程序了:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">wd-debug&gt; repl</div><div class="line">&gt; element</div><div class="line">function (locator) &#123;</div><div class="line">    return new ElementArrayFinder(ptor).all(locator).toElementFinder_();</div><div class="line">  &#125;</div><div class="line">&gt;</div></pre></td></tr></table></figure>
<h3 id="测试非angular的应用"><a href="#测试非angular的应用" class="headerlink" title="测试非angular的应用"></a>测试非angular的应用</h3><p>protractor内置方法测试angular的程序,例如它会自动检测angular页面加载完毕才会执行测试程序,当测试非angular程序的时候需要:</p>
<pre><code>- 1 使用 browser.driver 代替 driver
- 2 添加 browser.driver.ignoreSynchronization = true 
</code></pre><p><a href="https://github.com/sakshisingla/Protractor-Non-Angular-Tests/wiki/Creating-test-scripts-using-Protractor-for-non-angular-application" target="_blank">参考</a></p>
<h2 id="protractor的详细使用"><a href="#protractor的详细使用" class="headerlink" title="protractor的详细使用"></a>protractor的详细使用</h2><p>在protractor中,有几大类用于测试代码,详情请见<a href="https://angular.github.io/protractor/#/api" target="_blank">protractorAPI</a></p>
<ul>
<li>browser: 浏览器的操作</li>
<li>element &amp; by: 定位获取页面元素</li>
<li>ExpectedConditions:用于页面操作的逻辑函数,一般同wait连用</li>
<li>webdriver: selenium 原生的语法函数</li>
<li>promise:selenium内置的promise方法</li>
</ul>
<h3 id="浏览器的操作-browser"><a href="#浏览器的操作-browser" class="headerlink" title="浏览器的操作-browser"></a>浏览器的操作-browser</h3><p>常用操作代码如下:</p>
<ul>
<li>browser.get:</li>
<li>browser.findElement</li>
<li>browser.switchTo().frame()</li>
<li>browser.executeScript:</li>
<li>browser.executeAsyncScript</li>
<li>browser.wait:</li>
<li>browser.sleep:</li>
</ul>
<h3 id="选择器-by-amp-element"><a href="#选择器-by-amp-element" class="headerlink" title="选择器- by &amp; element"></a>选择器- by &amp; element</h3><p>支持多源选择器</p>
<ul>
<li>by.css()</li>
<li>by.id()</li>
<li>by.xpath()</li>
<li>by.name()</li>
<li>by.tagName()</li>
<li>by.model():angular专用</li>
<li>by.binding():angular专用</li>
<li>by.repeater():angular专用</li>
</ul>
<p>通过element获取:element(by.id(‘frameId’))或者element.all(by.css(‘some-css’));<br>在非angular应用中使用browser.driver.findElement(by.id(‘frameId’))</p>
<h3 id="ExpectedConditions"><a href="#ExpectedConditions" class="headerlink" title="ExpectedConditions"></a>ExpectedConditions</h3><p>预定义了wait的条件,常用的有</p>
<ul>
<li>elementToBeClickable: 按钮可以点击</li>
<li>presenceOf: 元素出现在dom中</li>
<li>titleContains: title含有某个字符串</li>
<li>visibilityOf: 某个元素显示</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> EC = protractor.ExpectedConditions;</div><div class="line"><span class="keyword">var</span> button = $(<span class="string">'#xyz'</span>);</div><div class="line"><span class="keyword">var</span> isClickable = EC.elementToBeClickable(button);</div><div class="line"></div><div class="line">browser.get(URL);</div><div class="line">browser.wait(isClickable, <span class="number">5000</span>); <span class="comment">//wait for an element to become clickable</span></div><div class="line">button.click();</div></pre></td></tr></table></figure>
<h3 id="综合实例"><a href="#综合实例" class="headerlink" title="综合实例"></a>综合实例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">it (<span class="string">'test login error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">       _driver.get(<span class="string">'http://subway.simba.taobao.com/#!/login'</span>);</div><div class="line">       _driver.wait(protractor.until.elementLocated(by.css(<span class="string">'.login-ifr'</span>)),<span class="number">1000</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">elem</span>) </span>&#123;</div><div class="line">           _driver.switchTo().frame(elem);</div><div class="line">           _driver.findElement(by.name(<span class="string">'TPL_username'</span>)).sendKeys(<span class="string">'zhangmeng1986712'</span>);</div><div class="line">           _driver.findElement(by.name(<span class="string">'TPL_password'</span>)).sendKeys(<span class="string">'xxxxx'</span>);</div><div class="line">           _driver.findElement(by.id(<span class="string">'J_SubmitStatic'</span>)).click();</div><div class="line">           _driver.sleep(<span class="number">1000</span>);</div><div class="line">           browser.driver.findElement(by.css(<span class="string">'.error'</span>)).then(<span class="function"><span class="keyword">function</span> (<span class="params">elem</span>) </span>&#123;</div><div class="line">               <span class="keyword">return</span> elem.getInnerHtml().then(<span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">                   expect(text).toMatch(<span class="string">'密码和账户名不匹配'</span>);</div><div class="line">               &#125;);</div><div class="line">           &#125;);</div><div class="line">       &#125;);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h2 id="page-object-pattern"><a href="#page-object-pattern" class="headerlink" title="page object pattern"></a>page object pattern</h2><p>page object的模式大家一定不陌生,通过合理的配置可以使测试代码更容易维护,举例来说可以这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">//书写一个input操作类</div><div class="line">var AngularHomepage = function() &#123;</div><div class="line">  var nameInput = element(by.model(&apos;yourName&apos;));</div><div class="line">  var greeting = element(by.binding(&apos;yourName&apos;));</div><div class="line"></div><div class="line">  this.get = function() &#123;</div><div class="line">    browser.get(&apos;http://www.angularjs.org&apos;);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  this.setName = function(name) &#123;</div><div class="line">    nameInput.sendKeys(name);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  this.getGreeting = function() &#123;</div><div class="line">    return greeting.getText();</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line">//测试代码</div><div class="line">describe(&apos;angularjs homepage&apos;, function() &#123;</div><div class="line">  it(&apos;should greet the named user&apos;, function() &#123;</div><div class="line">    var angularHomepage = new AngularHomepage();</div><div class="line">    angularHomepage.get();</div><div class="line">    angularHomepage.setName(&apos;Julie&apos;);</div><div class="line">    expect(angularHomepage.getGreeting()).toEqual(&apos;Hello Julie!&apos;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="mobile端的测试"><a href="#mobile端的测试" class="headerlink" title="mobile端的测试"></a>mobile端的测试</h2><p>详情<a href="https://angular.github.io/protractor/#/mobile-setup" target="_blank">参考</a><br>这个例子是使用Appium作为server端进行测试的,由于selenium-webdriver不能直接联Appium, 所以需要使用wd-bridge进行折衷.</p>
<h2 id="e2e测试程序设计准则"><a href="#e2e测试程序设计准则" class="headerlink" title="e2e测试程序设计准则"></a>e2e测试程序设计准则</h2><p><a href="https://angular.github.io/protractor/#/style-guide" target="_blank">参考</a></p>
<h2 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h2><p>本文的参考代码见 <a href="https://github.com/zhangmeng712/f2e-testing/tree/master/protractor" target="_blank">Github</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-04-17T07:02:37.000Z" itemprop="dateUpdated">2017-04-17 15:02:37</time>
</span><br>


        这里写留言或版权声明：<a href="/2016/03/10/f2e-testing-angular/" target="_blank" rel="external">https://mengbaby.github.io/2016/03/10/f2e-testing-angular/</a>
    </div>
    <footer>
        <a href="https://mengbaby.github.io">
            <img src="/img/avatar.jpeg" alt="Dr Meng">
            Dr Meng
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Mtags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Mtags/e2e/">e2e</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Mtags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Mtags/protractor/">protractor</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&title=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&pic=https://mengbaby.github.io/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&title=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&source=the more you know the more you know you don't know" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&via=https://mengbaby.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2016/02/10/f2e-testing-jest/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">前端自动化测试之单元测试（二）—— react组件的测试工具jest</h4>
      </a>
    </div>
  

  
</nav>



    




<section class="comments" id="comments">
    <div id="disqus_thread"></div>
    <script>
    var disqus_shortname = 'data4q-com';
    lazyScripts.push('//' + disqus_shortname + '.disqus.com/embed.js')
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>







</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>Dr Meng &copy; 2017</span>
        </p>
        <p><a href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备17021258号</a></p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&title=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&pic=https://mengbaby.github.io/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&title=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&source=the more you know the more you know you don't know" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《前端自动化测试（三）- angular和protracor》 — 萌小主前端部落&url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/&via=https://mengbaby.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://mengbaby.github.io/2016/03/10/f2e-testing-angular/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3aS3LCMBAFQO5/aXIAEvOexqQKqb2igmOrWUzN7/GIr+fL9frt9f2v97z+7/WdN1wYGBhfy3heXsmx2iPmT0vux8DAOIeRHCL5dvEQ8Xv//DsGBgZG+blNASehHAMDAyMPvvnhkjoUAwMDY62ITR7dtt7WvsXAwDiNkXfd///zR+YbGBgYX8V4llc7pGxbbGsXBgbG3ow8wI3Ky7jdNjkPBgbGrozrEJmXrJNGW7IW9gaGgYFxDGNtVasdDCRJZB6Ufwm4GBgY2zHaqDUZXibBdC3cY2BgnMCYtMPytHIS0KMWHgYGxqaMtkBthwdJCXodXqNiGAMDY2tGHkyTAJqviOVHTJ6AgYGxN2NSmk5Wx9qfI+oaYmBgbMpoR4ntKHSNelu2i4GBsQUjD4VteteuWXxk2QIDA2Mjxvz1STierFnUGS4GBsZ2jMl6RLswkY8nH+3vhIGBsTVj3tbPs7X2+VG4x8DA2JrRht125SJfNbvh58PAwDiAsVbKtosaa1OLaJyAgYFxAKNtlrXrFEnCt/ZMDAyM0xjt6+dNt8mYAQMD4wTGWmnark0kQTZf4HiT22JgYGzHmCxMtG21tdb/2igUAwNjP0bb4k9SwHbYOWnAYWBgnMNoA99aYrcWsqOFDAwMDIzxOLNtt9VUDAwMjMsELm/it0Vs8XYMDIwDGHnC1wbc+Xjg5nYbBgbGFzLWSse1oWNexN61AoKBgfHljB/YnsdlwYDTrAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };



</script>

<script src="//unpkg.com/hexo-theme-material-indigo@1.6.1/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@1.6.1/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '点我点我点我！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
